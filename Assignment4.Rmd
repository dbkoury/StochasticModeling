---
title: "Assignment4"
author: 'Team 2: Riti Dabas, Anoushka Mahar, Dylan Koury'
date: "12/2/2021"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##Part 1
```{r, echo=F}
PStar = 1.5 #Long run equilibrium price
Phi = -0.4 #Persistence factor
n = 10000 #number of prices
meanEr = 0 #Mean error
stdDvEr = 0.08 #Std Deviation error
set.seed(123)
error = rnorm(n=n, mean = meanEr, sd=stdDvEr)
PriceSimulator <- function(PStar, Phi, error) {
  Prices = c() #List of prices
  P0 = PStar #Setting initial price to equilibrium price
  for (i in 1:n) {
    pt = PStar*(1-Phi) + Phi*P0 + error[i]
    Prices = c(Prices, pt)
    P0 = pt
  }
  return(Prices)
}
Prices <- PriceSimulator(PStar,Phi,error)
```

##Part 2
```{r, echo=FALSE}
plot(ts(Prices[1:50]), main="First 50 Prices", ylab="Price", xlab="Time (unspecified)")
abline(h=mean(Prices[1:50]), col="dark green")
```
Looking at the graph, the prices appear stationary as there is an even distributon around the mean across all 50 temporal points.

DISCUSS HOW PROCESS WOULD CHANGE WITH PHI 0 OR 1

HOW EFFECTIVE CAN WE BE AT PREDICTING PRICES IN THESE CASES

##Part 3
```{r, echo=FALSE, warning=FALSE}
library(forecast)
Acf(Prices,lag.max = 10, plot=TRUE, type="correlation", ci=0.99)
Pacf(Prices, lag.max=10, plot=TRUE, ci=0.99)
```
The ACF shows us that there are 3 statistically significant correlations, with one borderline correlation.

#Part 4
```{r, echo=FALSE, warning=FALSE}
library(dynlm)
options(scipen=999)
PricesTS <- dynlm(Prices~L(Prices,-1))
summary(PricesTS)
```
INTERCEPT: -0.00000000000000255795 
SLOPE: 1.00000000000000177636 

##Part 5
```{r, echo=FALSE, warning=FALSE}
library(tidyverse)
avocado <- read_csv("avocado.csv")
Avocado_Prices <- ts(avocado$Avocado_Prices,frequency=52,start=c(2018,1))
```

##Part 6
```{r, echo=FALSE}
plot(Avocado_Prices, xlab="Year", ylab="Price ($)", main="Avocado Prices (2018-20)")
TimeMean = mean(Avocado_Prices) #Time Mean
abline(h=TimeMean,col="dark green")
```
Time Mean: `r TimeMean`

##Part 7
```{r, echo=FALSE}
Acf(Avocado_Prices,lag.max = 10, plot=TRUE, type="correlation", ci=0.99)
Pacf(Avocado_Prices,lag.max = 10, plot=TRUE, ci=0.99)
```

Describe the differences/similarities between these plots and the ones generated by your simulation in 3). 

##Part 8
```{r, echo=FALSE}

ar_1<-Arima(Avocado_Prices,order=c(1,0,0))
(ar_1)

AvocadoPhi <- ar_1$coef[1] #Phi
AvocadoPStar <- ar_1$coef[2] #/(1-AvocadoPhi) #Long Run Equilibrium Price
```


##Part 9
```{r, echo=FALSE}
AvocadoPriceSim <- ts(PriceSimulator(PStar=AvocadoPStar, Phi=AvocadoPhi, error=error),
                      frequency=52, start=c(2018,1))

plot(ts(AvocadoPriceSim[1:50]), xlab="Year", ylab="Price ($)", main="Avocado Prices (2018-20)")
TimeMeanSim = mean(AvocadoPriceSim) #Time Mean
abline(h=TimeMeanSim,col="dark green")

Acf(AvocadoPriceSim,lag.max = 10, plot=TRUE, type="correlation", ci=0.99)
Pacf(AvocadoPriceSim,lag.max = 10, plot=TRUE, ci=0.99)
```
##Part10
```{r, echo=FALSE}
AvocadoResiduals <- ar_1$residuals
Acf(AvocadoResiduals,lag.max = 10, plot=TRUE, type="correlation", ci=0.99)
Pacf(AvocadoResiduals,lag.max = 10, plot=TRUE, ci=0.99)
```
##Part 11
```{r, echo=FALSE}
forecasts <- forecast(Avocado_Prices)$mean[1:5]
```
#Part 12
```{r, echo=FALSE}
plot(ts(c(Avocado_Prices,forecasts),frequency=52,start=c(2018,1)),ylab="Price ($)",main="Avocado Prices and Forecast")
lines(ts(forecasts,frequency=52,start=c(2020,40)), col="red")
abline(h=mean(c(Avocado_Prices,forecasts)),col="darkgreen")
```








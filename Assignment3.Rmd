---
title: "Assignment 3"
author: 'Team 2: Riti Dabas, Anoushka Mahar, Dylan Koury'
date: "11/17/2021"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Summary
The business problem in this case study was that a company named Appshop is not sure of how to implement the financials of their OS-7 project, which extends to seven different locations of their client. Their options include taking a lower 24 months revenue that they proposed, an even lower monthly revenue with a potential added bonus and to make a bid with competing offers. We used the illustration of decision trees, equipping each option's expected value with its present value and running a simulation to get the most applicable and helpful data to solve our business problem. Our recommendation would highly depend on whether Appshop is a risk-taker or risk-averse. If Appshop is willing to be risk-taking, then we would advise them to consider Option 2 which includes taking the lowest monthly revenue with added bonus. However, if Appshop is risk-aversive, then it is recommended that they consider Option 1 which simply consist of receiving of a higher monthly revenue than Option 2. 

# Analysis
As previously mentioned, we have three options, Options 1,2 and 3. In Option 1, we simply have 24 months revenue of 155,000 dollars. We calculated the present value of all the revenue we would receive from this option using the FinCal package and put it as our expected value to get a better understanding of the revenue value. In Option 2, we did the similar procedure, however we multiplied the possibility of getting a bonus with the bonus's present value because we know that getting the bonus after the 24 months interval is not a guarenteed payment. Lastly, we ran a simulation for Option 3 where we took the potential payoffs in the bid and inserted them in a triangular distribution. Then, we took the average all the values we got from the simulation and added them to our present expected value. 


## Option 1

```{r echo=FALSE}
setwd("C:/Users/dylan/MSBA/SM/Assignments")
lbrHrs <- 1000
lbrCost <- 140
Mths <- 24
MonthlyCost <- lbrHrs*lbrCost
Op1Rev <- 155000
Op1Prof <- Op1Rev - MonthlyCost
DiscRate <- .005
#install.packages("FinCal")
library(FinCal)
Op1EV <- pv.annuity(r=DiscRate,n=Mths,pmt=-Op1Prof, type=0)
Op1EV <- Op1Prof*((1-(1+DiscRate)^-Mths)/DiscRate)
```

The first option is just monthly payments of `{r Op1Rev}` dollars. In order to get the expected value we must first find the monthly profit based on the monthly cost. With a cost of labor of `{r lbrCost}` dollars and Appshop working `{r lbrHrs}` hours a month, the monthly cost of this project would be `{r MonthlyCost}` dollars. This means that given this option's payment plan, Appshop's profit would be `{r Op1Prof}` dollars. 

The next step would be to find the present value of this annuity. Using Appshop's monthly discount rate of `{r DiscRate*100}`%, the expected value for this option is `{r round(Op1EV)}`.

## Option 2

```{r echo=FALSE}
Op2Rev <- 125000
Op2Prof <- Op2Rev - MonthlyCost
Bonus <- 1500000
PBonus <- .7
DiscAnnual <- .0617 
EVBonus <- pv(r=DiscAnnual,n=2,fv=-Bonus, type=0)

Op2EVRev <- pv.annuity(r=DiscRate,n=Mths,pmt=-Op2Prof, type=0)
Op2EVRev <- Op2Prof*((1-(1+DiscRate)^-Mths)/DiscRate)
Op2EV <- Op2EVRev + PBonus*(EVBonus)
```

The second option would give us the same monthly costs, but with a lower monthly revenue of `{r Op2Rev}` dollars, which is less than our monthly costs of `{r MonthlyCost}` meaning we have a net loss of `{r Op2Prof}` dollars. Discounting this to the present value the net loss is `{r round(Op2EVRev)}` dollars.

Besides a lower monthly revenue, this option offers a bonus at the end of the `{r Mths}` months if the work is completed with commendable performance. The bonus is worth `{r Bonus/1000000}` million dollars. Appshop believes they have a `{r PBonus*100}`% chance of receiving this bonus. Discounting to the present day with an annual rate of `{r DiscAnnual*100}`%, this bonus is worth `{r round(EVBonus, digits=0)}` dollars.

With a `{r PBonus*100}`% chance of receiving the bonus, the total expected value is `{r round(Op2EV)}` dollars. While this is higher than the expected value for the first option, with a `{(1-PBonus)*100}`% chance of not getting the bonus, choosing this option may result in a net loss. 

## Option 3

```{r echo=FALSE}
Op3Rev <- 150000
Op3Prof <- Op3Rev - MonthlyCost
PWin <- .45
SavingsLow <- 3200000
SavingsLikely <- 5600000
SavingsHigh <- 12800000
Mil4 <- 4000000
Mil6 <- 6000000
Mil8 <- 8000000


Op3EVRev <- pv.annuity(r=DiscRate,n=Mths,pmt=-Op3Prof, type=0)
Op3EVRev <- Op3Prof*((1-(1+DiscRate)^-Mths)/DiscRate)

rep = 100000
library(triangle)
savings <- rtriangle(n=rep,a=SavingsLow,b=SavingsHigh,c=SavingsLikely)
shares <- c()
for (i in savings) {
  if (i < Mil4) {
    shares <- c(shares, 0)
  } else if (i < Mil6) {
    shares <- c(shares, (i-Mil4)*.2)
  } else if (i < Mil8) {
    shares <- c(shares, 400000 + (i-Mil6)*.4)
  } else {c(shares, 1200000 + (i-Mil8)*.6)}
}
AvgShares <- mean(shares)
EVShares <- pv(r=DiscAnnual,n=2, fv=-AvgShares, type=0)
Op3EV <- PWin*(Op3EVRev + EVShares)
```

The final option requires Appshop to make a bid against competing offers. They plan to offer to complete the project for `{r Op3Rev}` dollars a month, giving them a monthly profit of `{r Op3Prof}` dollars. Discounted to the present, that is `{r round(Op3EVRev)}` dollars. Appshop believes that given their bidding strategy they have a `{PWin*100}`% chance of winning the bid.

However, there is a possibility to receive a greater expected value depending on the realized savings their project will offer the client. In the illustrations section is a table describing the share of savings the winning bidder can expect given the realized savings of the project.

Forecasting the potential savings of this project, Appshop predicts a low of `{r SavingsLow/1000000}` million dollars, a high of `{r SavingsHigh/1000000}` million dollars, and a most likely value of `{r SavingsLikely/1000000}` million dollars. 

In order to estimate the expected value of the share of savings given this triangle distribution, we simulated `{r rep}` trial outcomes. We found that the average savings were about `{r round(mean(savings))}` dollars, giving an average share of savings of `{r round(AvgShares)}` dollars. Discounted to the present that is `{r round(EVShares)}` dollars. Given the probability of winning the bid, the expected value of this option is `{r round(Op3EV)}` dollars.

# Illustration

### Share of Savings Table

![ShareofSavings](ShareofSavings.jpeg)

### Histogram of Savings
```{r savings, echo=FALSE}
hist(savings/1000000, xlab="Savings (in $ millions)", main = "AppShop Project Savings", col="dodgerblue1")
```

### Histogram of Share of Savings
```{r shares, echo=FALSE}
hist(shares, xlab="Share of Savings (in dollars)", main = "AppShop Share of Savings", col="dodgerblue1")
```

### Decision tree

# Conclusion
As previously mentioned, our recommendation would depend on whether Appshop is risk-taking or risk-aversive. If Appshop is risk-taking, then it is recommended that they go with Option 2 with the monthly revenue of 125,000 dollars and a potential added bonus of 1.5 million dollars after 24 months. However, if Appshop is risk-aversive, then they should take Option 1, monthly revenue of 155,000 dollars. 
Since we are using predictive analysis, where we take data from previous experience and judgement and use them to solve a new current problem, there are bound to some pitfalls which would potentially decrease the accuracy of our analysis. Firstly, if we are using numbers that include finding the probability to receive bonuses or forecasting client's savings, large amount of relevant data is required to get a good result. And a lot of times, especially Appshop who does not seem to be as big and resourceful as its Big-4 competitors, big data sets are hard to come by. Additionally there are other variables that were not covered or were not known to Appshop, such as the true client savings, a new potential competitor who can outbid Appshop etc. 
